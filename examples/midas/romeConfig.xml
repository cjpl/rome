<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- $Id$ -->

<!-- Please check ROME homepage for details of tags
http://midas.psi.ch/rome/romeConfigSchemaDocumentation.htm -->

<Configuration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="c:\rome\romeConfig.xsd">
  <ProgramConfiguration>
    <!-- The program mode. Must be one of the following : 0 : analyzer; 1 : monitor; 2 : analyzer and monitor; 3 : monitor connected to an analyzer. (required) -->
    <ProgramMode>0</ProgramMode>
  </ProgramConfiguration>

  <MainConfiguration>
    <Modes>
      <!-- Description of the modes in which the framework can run. -->
      <!-- Describes the analyzing mode. This can be 'online' or 'offline'. Default is offline -->
      <AnalyzingMode>online</AnalyzingMode>
      <!-- Describes the DAQ system used for IO. This can be 'none', 'midas', 'root' or a user defined DAQ system. Default is none. -->
      <DAQSystem>midas</DAQSystem>
    </Modes>

    <Offline>
      <!-- Description of the offline specific configuration. -->
      <!-- The run numbers of runs, which have to be analyzed. The following syntax must be used : 1,3-5,7,9-12. All runs must be specified in the 'MainConfiguration' even if they are overriden by a 'RunConfiguration'. (required for offline) -->
      <RunNumbers>1</RunNumbers>
      <!-- The event numbers, which have to be analyzed. Use the same syntax as for the run numbers. (optional) -->
      <EventNumbers></EventNumbers>
      <!-- The input file names containing the runs, which have to be analyzed. If no input file is specified the DAQ systems will work with a run number based file IO. All files must be specified in the 'MainConfiguration' even if they are overriden by a 'RunConfiguration'. (optional) -->
      <InputFileNames></InputFileNames>
    </Offline>

    <Online>
      <!-- Description of the online specific configuration. -->
      <!-- The name of the host of the online experiment. (required) -->
      <Host></Host>
      <!-- The name of the online experiment. (required) -->
      <Experiment></Experiment>
      <!-- The name of the analyzer in the midas environment. Can be used to run two analyzer in parallel. (optional) -->
      <AnalyzerName>Analyzer</AnalyzerName>
      <!-- The name of the memory buffer to be accessed. (optional) -->
      <MemoryBuffer>SYSTEM</MemoryBuffer>
    </Online>

    <Paths>
      <!-- Description of the file paths the framework is using. -->
      <!-- The path of all input files. (required) -->
      <InputFilePath>./</InputFilePath>
      <!-- The path of all output files. (optional) -->
      <OutputFilePath>./</OutputFilePath>
      <!-- Specify option to open output files for trees and histograms. This should be RECREATE, UPDATE or NUMBERED. When this is NUMBERED, the program will create a new file with appending a number at the end of file name, when it finds existing file. (optional) -->
      <OutputFileOption>RECREATE</OutputFileOption>
      <!-- Make file system directories for output files. -->
      <MakeOutputDirectory>false</MakeOutputDirectory>
    </Paths>

    <Common>
      <!-- Describes the framework specifications, which are common for analyzer and monitors. -->
      <Settings>
        <!-- Description of the common settings of the framework. -->
        <!-- Specify amount of messages from framework. mute, error, warning, normal, verbose or debug. default is normal. -->
        <VerboseLevel>normal</VerboseLevel>
        <!-- Specify max number of prints of an identical error or warning by ROMEPrint::Report. No limit when this is 0. -->
        <ReportMaxCount>20</ReportMaxCount>
        <!-- Amount of comments in configuration xml file. 0 to 5. You have more comments when this is larger. degault is 1. -->
        <ConfigCommentLevel>5</ConfigCommentLevel>
        <!-- If true, the program doesn't start a root session at the end. Default is false. -->
        <QuitMode>false</QuitMode>
        <!-- Program shows a splash screen, when starting up. Default is true. -->
        <ShowSplashScreen>false</ShowSplashScreen>
        <!-- Configuration file can be modified in a GUI at start up. -->
        <GraphicalConfigEdit>true</GraphicalConfigEdit>
        <!-- Flag if configuration XML file is overwritten by program. When this is true, program does not overwrite configuration file. -->
        <PreserveConfig>false</PreserveConfig>
      </Settings>

      <FloatingPointExceptionTrap>
        <!-- Description of the settings of floating point exception trap. -->
        <!-- If true, trap invalid operation. (NaNS, INF-INF, INF/INF, 0/0, INF*0, sqrt(Negative) and so on) -->
        <Invalid>false</Invalid>
        <!-- If true, trap division by zero. -->
        <DivByZero>false</DivByZero>
        <!-- If true, trap overflow. -->
        <Overflow>false</Overflow>
        <!-- If true, trap underflow. -->
        <Underflow>false</Underflow>
        <!-- If true, trap inexact operations. -->
        <Inexact>false</Inexact>
      </FloatingPointExceptionTrap>

      <SocketServer>
        <!-- Description of the socket server. External programs can access the objects inside the framework over a root socket interface. -->
        <!-- The socket server is per default not available. This flag activates it. Default is false. -->
        <Active>false</Active>
        <!-- The number of the port for the socket server. Default is 9090. -->
        <PortNumber>9090</PortNumber>
      </SocketServer>

      <DataBases>

        <DataBase>
          <!-- Describes a data base, to which the framework should be connected. -->
          <!-- The name of the data base connection. (required) -->
          <Name>odb</Name>
          <!-- The connection string to initialize the database. For xml: "path;databasename". For sql: "mysql://username:password@servername:portnumber/databasename". For text: "your/database/directory". (required) -->
          <Connection>odb</Connection>
          <!-- The type of the data base. (required) -->
          <Type>odb</Type>
          <!-- If this is true the database gets read at each event. The '#' in the path means then event number. Default is false. (optional) -->
          <EventBased>false</EventBased>
        </DataBase>
      </DataBases>

      <Trees>
        <Accumulate>false</Accumulate>
        <Tree>
          <TreeName>run</TreeName>
          <!-- Trees can be read into the framework to start the analysis from a previously saved state. Default is false. -->
          <Read>false</Read>
          <!-- Trees are written to disc. Default is false. -->
          <Write>true</Write>
          <!-- Trees are filled. It will be changed to true when 'Write' is true. Default is false. -->
          <Fill>true</Fill>
          <!-- Compression level for all branches of the tree. Default is 0. -->
          <CompressionLevel>1</CompressionLevel>
          <!-- If this value is greater than 0 the tree is a circular tree with the specified size. Default is 0. -->
          <MaxNumberOfEntries>0</MaxNumberOfEntries>
          <!-- The name of the trees input file. This value overwrites the value specified in the definition file. (optional) -->
          <TreeInputFileName></TreeInputFileName>
          <!-- The name of the trees output file. This value overwrites the value specified in the definition file. (optional) -->
          <TreeOutputFileName></TreeOutputFileName>
          <!-- If this is true, content of configuration XML file will be saved in the output file. Default is false -->
          <SaveConfiguration>false</SaveConfiguration>
          <Branch>
            <!-- Description of a branch. -->
            <BranchName>Data</BranchName>
            <!-- Inactive branches are not filled by the framework. (optional) -->
            <Active>true</Active>
          </Branch>
        </Tree>
      </Trees>

      <GlobalSteeringParameters>
        <SteeringParameterField>
          <SPName>TestValue</SPName>
          <SPValue>0</SPValue>
        </SteeringParameterField>
      </GlobalSteeringParameters>
    </Common>

    <Analyzer>
      <!-- Describes the framework specifications, which are used for an analyzer. -->
      <HistogramRead>
        <!-- Description of the histogram/graph reading. -->
        <!-- Read flag. (required) -->
        <Read>false</Read>
        <!-- Run numbers of the required histogram/graph file. (required) -->
        <RunNumber>0</RunNumber>
        <!-- directory path to read histogram/graph file. (optional) -->
        <Path>./</Path>
        <!-- The name of the histogram input file. (optional) -->
        <FileName></FileName>
      </HistogramRead>

      <HistogramWrite>
        <!-- Description of the histogram/graph writing. -->
        <!-- Write flag. (required) -->
        <Write>true</Write>
        <!-- directory path to write histogram/graph file. (optional) -->
        <Path>./</Path>
        <FileName></FileName>
        <!-- If this value is true all the histograms and graphs are not reset by framework. Default is false. -->
        <AccumulateAll>false</AccumulateAll>
        <AutoSavePeriod>0</AutoSavePeriod>
      </HistogramWrite>

      <Macros>
        <!-- Description of macros. -->
        <!-- Macro file name which is executed at the begin of run. It is executed after Tasks::BeginOfRun. (optional) -->
        <BeginOfRun></BeginOfRun>
        <!-- Macro file name which is executed at the begin of event. It is executed before Tasks::Event. (optional) -->
        <BeginOfEvent></BeginOfEvent>
        <!-- Macro file name which is executed at the end of event. It is executed after Tasks::Event. (optional) -->
        <EndOfEvent></EndOfEvent>
        <!-- Macro file name which is executed at the end of run. It is executed after Tasks::EndOfRun. (optional) -->
        <EndOfRun></EndOfRun>
      </Macros>

      <Tasks>
        <Task>
          <TaskName>PrintValues</TaskName>
          <!-- Inactive tasks are not executed by the framework. Default is true. -->
          <Active>true</Active>
          <SteeringParameterField>
            <SPName>TaskTestValue</SPName>
            <SPValue>0</SPValue>
          </SteeringParameterField>
        </Task>
      </Tasks>
    </Analyzer>

    <Monitor>
      <!-- Describes the framework specifications, which are used for a monitor. -->
      <SocketClient>
        <!-- Description of the socket client connection to the ROME analyzer. This section is needed if the program mode is 3. -->
        <!-- Host which runs the ROME analyzer. -->
        <Host>localhost</Host>
        <!-- Port number for the socket connection. -->
        <Port>9090</Port>
      </SocketClient>
    </Monitor>

    <Midas>
      <!-- Describes the midas dependent part of the framework. -->
      <!-- When it is true, framework does byte swapping when reading MIDAS files. Default is false. -->
      <MidasByteSwap>false</MidasByteSwap>
      <!-- When it is true, in online mode, framework communicates with MIDAS server by using dedicated thread. You may use this option when you have time consuming functions in event loop. When there is a time consuming function in event loop, the program may not receive signals from MIDAS server to start/stop runs. This can cause error in MIDAS server. Timeout of MIDAS communication is different depends on OS, it is typically around 1 minute. If this option is true, ODB functions in user code may not work properly, because MIDAS communication is implemented with assuming done in a thread. -->
      <MidasOnlineCommunicationThread>false</MidasOnlineCommunicationThread>
      <!-- Loop period to read online midas event from experiment in milli second. If you set small number, analyzer reads events frequently. If it is too much load for midas server, you may increase this number. Positive number or 0 is valid. -->
      <MidasOnlineLoopPeriod>10</MidasOnlineLoopPeriod>
      <Event>
        <!-- Description of a midas event. -->
        <EventName>Trigger</EventName>
        <!-- If true, this event type will be analyzed. Default is false. -->
        <Active>true</Active>
        <Bank>
          <!-- Description of a midas bank. -->
          <BankName>ADC0</BankName>
          <!-- If true, this bank will be analyzed. Default is false. -->
          <Active>true</Active>
        </Bank>
        <Bank>
          <!-- Description of a midas bank. -->
          <BankName>TDC0</BankName>
          <!-- If true, this bank will be analyzed. Default is false. -->
          <Active>true</Active>
        </Bank>
        <Bank>
          <!-- Description of a midas bank. -->
          <BankName>STRT</BankName>
          <!-- If true, this bank will be analyzed. Default is false. -->
          <Active>true</Active>
        </Bank>
      </Event>

      <Event>
        <!-- Description of a midas event. -->
        <EventName>Scaler</EventName>
        <!-- If true, this event type will be analyzed. Default is false. -->
        <Active>true</Active>
        <Bank>
          <!-- Description of a midas bank. -->
          <BankName>SCLR</BankName>
          <!-- If true, this bank will be analyzed. Default is false. -->
          <Active>true</Active>
        </Bank>
      </Event>

      <Event>
        <!-- Description of a midas event. -->
        <EventName>Environment</EventName>
        <!-- If true, this event type will be analyzed. Default is false. -->
        <Active>true</Active>
        <Bank>
          <!-- Description of a midas bank. -->
          <BankName>INPT</BankName>
          <!-- If true, this bank will be analyzed. Default is false. -->
          <Active>true</Active>
        </Bank>
      </Event>
    </Midas>
  </MainConfiguration>
</Configuration>
